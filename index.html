<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Reading Notes of TZX</title>
<!-- 2018-01-13 Sat 18:50 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="TANG ZhiXiong" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="css/hideshow.css"/>
<link rel="stylesheet" type="text/css" href="css/github-gist.min.css">
<link rel="stylesheet" type="text/css" href="css/main.css"/>
<script type="text/javascript" src="javascript/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="javascript/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="javascript/jquery.zclip.min.js"></script>
<script type="text/javascript" src="javascript/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="javascript/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="javascript/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="javascript/bigblow.js"></script>
<script type="text/javascript" src="javascript/hideshow.js"></script>
<script type="text/javascript" src="javascript/highlight.min.js"></script>
<script type="text/javascript" src="javascript/main.js"></script>
<script type="text/javascript">$(function(){ addSourceLink().useHtmlRef().navToSecondTab(); });</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Reading Notes of TZX</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. ☰</a>
<ul>
<li><a href="#sec-1-1">1.1. Meta Notes</a></li>
<li><a href="#sec-1-2">1.2. Books</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. <span class="done DONE">DONE</span> Combo #1</a></li>
<li><a href="#sec-1-2-2">1.2.2. <span class="todo INPROGRESS">INPROGRESS</span> Combo #2</a></li>
<li><a href="#sec-1-2-3">1.2.3. <span class="done DONE">DONE</span> JavaScript: The Good Parts</a></li>
<li><a href="#sec-1-2-4">1.2.4. <span class="done DONE">DONE</span> Domain Specific Languages</a></li>
<li><a href="#sec-1-2-5">1.2.5. <span class="todo INPROGRESS">INPROGRESS</span> Effective Java</a></li>
<li><a href="#sec-1-2-6">1.2.6. <span class="done DONE">DONE</span> Don't Make Me Think</a></li>
<li><a href="#sec-1-2-7">1.2.7. <span class="done DONE">DONE</span> Clean Code</a></li>
<li><a href="#sec-1-2-8">1.2.8. <span class="todo INPROGRESS">INPROGRESS</span> Deep Learning</a></li>
<li><a href="#sec-1-2-9">1.2.9. <span class="todo INPROGRESS">INPROGRESS</span> Async JavaScript</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-2">2. Writing Rules</a></li>
<li><a href="#sec-3">3. <span class="todo TODO">TODO</span> Methodology</a>
<ul>
<li><a href="#sec-3-1">3.1. Project-based Learning</a></li>
<li><a href="#sec-3-2">3.2. Structured Thinking</a></li>
<li><a href="#sec-3-3">3.3. Deliberate Practice</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Code Reading</a>
<ul>
<li><a href="#sec-4-1">4.1. <span class="done DONE">DONE</span> </a></li>
<li><a href="#sec-4-2">4.2. <span class="done DONE">DONE</span> </a></li>
<li><a href="#sec-4-3">4.3. <span class="todo TODO">TODO</span> </a></li>
<li><a href="#sec-4-4">4.4. <span class="todo TODO">TODO</span> </a></li>
<li><a href="#sec-4-5">4.5. <span class="done DONE">DONE</span> </a>
<ul>
<li><a href="#sec-4-5-1">4.5.1. 啥是 promise</a></li>
<li><a href="#sec-4-5-2">4.5.2. chaining</a></li>
<li><a href="#sec-4-5-3">4.5.3. combination</a></li>
<li><a href="#sec-4-5-4">4.5.4. sequential</a></li>
<li><a href="#sec-4-5-5">4.5.5. then end</a></li>
<li><a href="#sec-4-5-6">4.5.6. create a promise</a></li>
<li><a href="#sec-4-5-7">4.5.7. deferred</a></li>
<li><a href="#sec-4-5-8">4.5.8. the promise</a></li>
</ul>
</li>
<li><a href="#sec-4-6">4.6. <span class="done DONE">DONE</span> </a></li>
<li><a href="#sec-4-7">4.7. <span class="todo INPROGRESS">INPROGRESS</span> </a>
<ul>
<li><a href="#sec-4-7-1">4.7.1. <span class="done DONE">DONE</span> JavaScript</a></li>
<li><a href="#sec-4-7-2">4.7.2. SQL</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> ☰</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li><a href="./index.html">Main Entry</a>
</li>
</ul>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Meta Notes</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="./00001-emacs-org-mode.html">Emacs/Org-mode Notes</a>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Books</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> <span class="done DONE">DONE</span> <a href="./00001-combo-001.html">Combo #1</a></h4>
<div class="outline-text-4" id="text-1-2-1">
</div><ol class="org-ol"><li><a id="sec-1-2-1-1" name="sec-1-2-1-1"></a><span class="done DONE">DONE</span> 金字塔原理<br  /></li>
<li><a id="sec-1-2-1-2" name="sec-1-2-1-2"></a><span class="todo TODO">TODO</span> Beast Machines: Transformers (cartoon)<br  /></li>
<li><a id="sec-1-2-1-3" name="sec-1-2-1-3"></a><span class="done DONE">DONE</span> 论持久战<br  /></li>
<li><a id="sec-1-2-1-4" name="sec-1-2-1-4"></a><span class="done DONE">DONE</span> 一看就懂的经济常识全图解<br  /></li>
<li><a id="sec-1-2-1-5" name="sec-1-2-1-5"></a><span class="done DONE">DONE</span> 刻意练习<br  /></li>
<li><a id="sec-1-2-1-6" name="sec-1-2-1-6"></a><span class="done DONE">DONE</span> 系统之美<br  /></li>
<li><a id="sec-1-2-1-7" name="sec-1-2-1-7"></a><span class="done DONE">DONE</span> 邓小平时代<br  /></li></ol>
</div>
<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> <span class="todo INPROGRESS">INPROGRESS</span> <a href="./00006-combo-002.html">Combo #2</a></h4>
<div class="outline-text-4" id="text-1-2-2">
</div><ol class="org-ol"><li><a id="sec-1-2-2-1" name="sec-1-2-2-1"></a><span class="done DONE">DONE</span> 新经济, 新规则 (Kevin Kelly)<br  /></li>
<li><a id="sec-1-2-2-2" name="sec-1-2-2-2"></a><span class="done DONE">DONE</span> 麦肯锡问题解决方法与技巧<br  /></li></ol>
</div>
<div id="outline-container-sec-1-2-3" class="outline-4">
<h4 id="sec-1-2-3"><span class="section-number-4">1.2.3</span> <span class="done DONE">DONE</span> <a href="./00002-javascript-the-good-parts.html">JavaScript: The Good Parts</a></h4>
</div>
<div id="outline-container-sec-1-2-4" class="outline-4">
<h4 id="sec-1-2-4"><span class="section-number-4">1.2.4</span> <span class="done DONE">DONE</span> <a href="./00004-domain-specific-languages.html">Domain Specific Languages</a></h4>
</div>
<div id="outline-container-sec-1-2-5" class="outline-4">
<h4 id="sec-1-2-5"><span class="section-number-4">1.2.5</span> <span class="todo INPROGRESS">INPROGRESS</span> <a href="./00003-effective-java.html">Effective Java</a></h4>
</div>
<div id="outline-container-sec-1-2-6" class="outline-4">
<h4 id="sec-1-2-6"><span class="section-number-4">1.2.6</span> <span class="done DONE">DONE</span> <a href="./00005-dont-make-me-think.html">Don't Make Me Think</a></h4>
</div>
<div id="outline-container-sec-1-2-7" class="outline-4">
<h4 id="sec-1-2-7"><span class="section-number-4">1.2.7</span> <span class="done DONE">DONE</span> <a href="./00007-clean-code.html">Clean Code</a></h4>
</div>
<div id="outline-container-sec-1-2-8" class="outline-4">
<h4 id="sec-1-2-8"><span class="section-number-4">1.2.8</span> <span class="todo INPROGRESS">INPROGRESS</span> <a href="./00008-deep-learning.html">Deep Learning</a></h4>
</div>
<div id="outline-container-sec-1-2-9" class="outline-4">
<h4 id="sec-1-2-9"><span class="section-number-4">1.2.9</span> <span class="todo INPROGRESS">INPROGRESS</span> <a href="./00009-async-javascript.html">Async JavaScript</a></h4>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Writing Rules</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>参考 <a href="https://github.com/sparanoid/chinese-copywriting-guidelines">Chinese copywriting guidelines for better written communication／中文文案排版指北</a>
</li>
<li>其他
<ul class="org-ul">
<li>标点: 使用英文标点
</li>
<li>缩进:
<ul class="org-ul">
<li>markdown 使用四个空格, 使用 <code>-</code> 来做 bullet
</li>
<li>org-mode 使用两个空格 (虽然我喜欢四个), 使用 <code>-</code> 和 <code>+</code>  交替来做 bullet
</li>
</ul>
</li>
<li>空行:
<ul class="org-ul">
<li>markdown 多加空行, e.g. 在块元素前后加空行 (但不能有连续空行)
</li>
<li>org-mode 少加空行, e.g. 在块元素前后不加空行 (能少则少, 不同 chap/sec/subsec 之间也不加空行)

<p>
Why? 因为 org-mode 的折叠可能会把空行折叠进去, 也可能不. 这样很
不 consistent. 所以直接去掉.
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> <span class="todo TODO">TODO</span> Methodology</h2>
<div class="outline-text-2" id="text-3">
<blockquote>
<p>
有困难解决困难。没有困难创造困难，然后解决困难。
</p>
</blockquote>
</div>
<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Project-based Learning</h3>
<div class="outline-text-3" id="text-3-1">
<p>
学习一定应该是“项目型的学习”（Project-based Learning）以及带着解决问
题的目标去学习，而这目标必须是某个现实的目标，而不是一种教科书上的编造。
</p>

<p>
Students learn about a subject by working for an extended period of
time to investigate and respond to a complex question, challenge, or
problem. It is a style of active learning and inquiry-based
learning. PBL contrasts with paper-based, rote memorization, or
teacher-led instruction that presents established facts or portrays a
smooth path to knowledge by instead posing questions, problems or
scenarios.
</p>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Structured Thinking</h3>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Deliberate Practice</h3>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Code Reading</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> <span class="done DONE">DONE</span> <a href="https://github.com/4ker/JavaAOP">https://github.com/4ker/JavaAOP</a></h3>
<div class="outline-text-3" id="text-4-1">
<p>
AOP 的一个实现, 大致逻辑是:
</p>
<ul class="org-ul">
<li>用 Java 的反射功能可以拿到一个对象的 method 和 field (还可以包括继承来的)
</li>
<li>然后用 Java 的 Proxy 给原来的对象封装一层, 在函数调用的时候插入逻辑
</li>
<li>插入的逻辑标记在 annotation 里面
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> <span class="done DONE">DONE</span> <a href="https://github.com/4ker/gradle-build-scan-quickstart">https://github.com/4ker/gradle-build-scan-quickstart</a></h3>
<div class="outline-text-3" id="text-4-2">
<p>
很多有用的文档:
_ Learn groovy in y minutes ::
</p>
<ul class="org-ul">
<li><a href="https://github.com/adambard/learnxinyminutes-docs/blob/master/groovy.html.markdown">https://github.com/adambard/learnxinyminutes-docs/blob/master/groovy.html.markdown</a>
</li>
<li>IntelliJ: Tools &#x2013; Groovy Console
</li>
<li>[l, i, s, t], [m: a, p: map]
</li>
<li>{function block}
</li>
</ul>
<p>
内容主要有:
(setq-default tab-width 2)
</p>
<ul class="org-ul">
<li>gradle 相关命令
</li>
<li>groovy 语法
</li>
</ul>
<div class="org-src-container">

<pre class="src src-shell">gradle tasks
gradle help --task checkStyleMain
gradle properties
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> <span class="todo TODO">TODO</span> <a href="https://github.com/4ker/Photo-Sphere-Viewer">https://github.com/4ker/Photo-Sphere-Viewer</a></h3>
<div class="outline-text-3" id="text-4-3">
<p>
Photo Sphere Viewer is a JavaScript library that allows you to display
360×180 degrees panoramas on any web page. Panoramas must use the
equirectangular projection and can be taken with the Google Camera,
the Ricoh Theta or any 360° camera.
</p>
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> <span class="todo TODO">TODO</span> <a href="https://github.com/4ker/gtor">https://github.com/4ker/gtor</a></h3>
<div class="outline-text-3" id="text-4-4">
<p>
<a href="https://github.com/4ker/gtor/blob/master/presentation/README.md">https://github.com/4ker/gtor/blob/master/presentation/README.md</a>
</p>
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5"><span class="section-number-3">4.5</span> <span class="done DONE">DONE</span> <a href="https://github.com/4ker/q">https://github.com/4ker/q</a></h3>
<div class="outline-text-3" id="text-4-5">
<p>
这个文档很赞. 可以多读几遍.
</p>
</div>
<div id="outline-container-sec-4-5-1" class="outline-4">
<h4 id="sec-4-5-1"><span class="section-number-4">4.5.1</span> 啥是 promise</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>
A promise is an object that represents the return value or the thrown
exception that the function may eventually provide. A promise can also
be used as a proxy for a remote object to overcome latency.
就是一个许诺返回的对象. 当然, 值返回不成功, 就返回一个异常.
</p>
<div class="org-src-container">

<pre class="src src-js">Q.fcall(promisedStep1)
.then(promisedStep2)
.then(promisedStep3)
.then(promisedStep4)
.then(function (value4) {
    // Do something with value4
})
.catch(function (error) {
    // Handle any error from all above steps
})
.done();
</pre>
</div>
<p>
常规使用方法是, 一个 promise 可以 <code>.then</code> 来处理.
then 方法的输入是两个函数, 一个 resolver, 一个 rejector.
</p>
<div class="org-src-container">

<pre class="src src-js">promiseMeSomething()
    .then(function (value) {
        ...
    }, function (reason) {
        ...
    });
</pre>
</div>
<p>
而且 then 返回的也是一个 promise, 这样就能不断 propagate 出去. bubble out.
</p>

<p>
<code>fail</code> 是一种 <code>then(null, resolver)</code> 的语法糖.
</p>
</div>
</div>
<div id="outline-container-sec-4-5-2" class="outline-4">
<h4 id="sec-4-5-2"><span class="section-number-4">4.5.2</span> chaining</h4>
<div class="outline-text-4" id="text-4-5-2">
<div class="org-src-container">

<pre class="src src-js">// nested chaining
return getUsername()
    .then(function (username) {
        return getUser(username)
            .then(function (user) {
                // if we get here without an error,
                // the value returned here
                // or the exception thrown here
                // resolves the promise returned
                // by the first line
            })
    });

// handler
return getUsername()
    .then(function (username) {
        return getUser(username);
    })
    .then(function (user) {
        // if we get here without an error,
        // the value returned here
        // or the exception thrown here
        // resolves the promise returned
        // by the first line
    });

// 按情况混用
function authenticate() {
    return getUsername()
        .then(function (username) {
            return getUser(username);
        })
        // chained because we will not need the user name in the next event
        .then(function (user) {
            return getPassword()
                // nested because we need both user and password next
                .then(function (password) {
                    if (user.passwordHash !== hash(password)) {
                        throw new Error("Can't authenticate");
                    }
                });
        });
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-3" class="outline-4">
<h4 id="sec-4-5-3"><span class="section-number-4">4.5.3</span> combination</h4>
<div class="outline-text-4" id="text-4-5-3">
<div class="org-src-container">

<pre class="src src-js">return Q.all([
    eventualAdd(2, 2),
    eventualAdd(10, 20)
]);
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-4" class="outline-4">
<h4 id="sec-4-5-4"><span class="section-number-4">4.5.4</span> sequential</h4>
<div class="outline-text-4" id="text-4-5-4">
<div class="org-src-container">

<pre class="src src-js">// 对 initialVal 进行一系列操作, 怎么写?
return foo(initialVal).then(bar).then(baz).then(qux);

// 输入是 initialVal 和 funcs
var funcs = [foo, bar, baz, qux];

// 一般实现
var result = Q(initialVal);
funcs.forEach(function (f) {
    result = result.then(f);
});
return result;

// 用 reduce
return funcs.reduce(function (soFar, f) {
    return soFar.then(f);
}, Q(initialVal));

// 用 compact 的实现
return funcs.reduce(Q.when, Q(initialVal));

// TODO: check Q.when 是否就是 Q.when = p =&gt; p.then
</pre>
</div>
<p>
The when function is the static equivalent for then.
</p>

<div class="org-src-container">

<pre class="src src-js">return Q.when(valueOrPromise, function (value) {
}, function (error) {
});
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-5" class="outline-4">
<h4 id="sec-4-5-5"><span class="section-number-4">4.5.5</span> then end</h4>
<div class="outline-text-4" id="text-4-5-5">
<div class="org-src-container">

<pre class="src src-js">// return it
return foo()
    .then(function () {
        return "bar";
    });

// end it
return foo()
    .then(function () {
        return "bar";
    });
// either return it
return foo()
    .then(function () {
        return "bar";
    });

// or end it
foo()
    .then(function () {
        return "bar";
    })
    .done();
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-6" class="outline-4">
<h4 id="sec-4-5-6"><span class="section-number-4">4.5.6</span> create a promise</h4>
<div class="outline-text-4" id="text-4-5-6">
<div class="org-src-container">

<pre class="src src-js">// from a func that returns
return Q.fcall(function () {
    return 10;
});


// from a func that throws
return Q.fcall(function () {
    throw new Error("Can't do it");
});

// from a fcall
return Q.fcall(eventualAdd, 2, 2);
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-7" class="outline-4">
<h4 id="sec-4-5-7"><span class="section-number-4">4.5.7</span> deferred</h4>
<div class="outline-text-4" id="text-4-5-7">
<p>
callback to promise:
</p>
<div class="org-src-container">

<pre class="src src-js">// wrap it
var deferred = Q.defer();
FS.readFile("foo.txt", "utf-8", function (error, text) {
    if (error) {
        deferred.reject(new Error(error));
    } else {
        deferred.resolve(text);
    }
});
return deferred.promise;

// use it
deferred.reject(new Error("Can't do it"));
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-8" class="outline-4">
<h4 id="sec-4-5-8"><span class="section-number-4">4.5.8</span> the promise</h4>
<div class="outline-text-4" id="text-4-5-8">
<div class="org-src-container">

<pre class="src src-js">function requestOkText(url) {
    return Q.Promise(function(resolve, reject, notify) {
        var request = new XMLHttpRequest();

        request.open("GET", url, true);
        request.onload = onload;
        request.onerror = onerror;
        request.onprogress = onprogress;
        request.send();

        function onload() {
            if (request.status === 200) {
                resolve(request.responseText);
            } else {
                reject(new Error("Status code was " + request.status));
            }
        }

        function onerror() {
            reject(new Error("Can't XHR " + JSON.stringify(url)));
        }

        function onprogress(event) {
            notify(event.loaded / event.total);
        }
    });
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6"><span class="section-number-3">4.6</span> <span class="done DONE">DONE</span> <a href="https://github.com/district10/You-Dont-Need-jQuery">https://github.com/district10/You-Dont-Need-jQuery</a></h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">

<pre class="src src-js">// jQuery -------------------------------------------
$('selector');

// Native
document.querySelectorAll('selector');

document.getElementsByClassName('class');
document.getElementById('id');

// jQuery -------------------------------------------
$el.css({ color: '#f01' });

// Native
el.style.color = '#f01';

// jQuery -------------------------------------------
$el.addClass(className);
$el.removeClass(className);
$el.toggleClass(className);

// Native
el.classList.add(className);
el.classList.remove(className);
el.classList.toggle(className); // 这些东西不是 list 操作.

// jQuery -------------------------------------------
$el.remove();

// Native
el.parentNode.removeChild(el);

// jQuery -------------------------------------------
$el.append('&lt;div id="container"&gt;Hello World&lt;/div&gt;');

// Native (HTML string)
el.insertAdjacentHTML('beforeend', '&lt;div id="container"&gt;Hello World&lt;/div&gt;');

// Native (Element)
el.appendChild(newEl);

// jQuery -------------------------------------------
$el.prepend('&lt;div id="container"&gt;Hello World&lt;/div&gt;');

// Native (HTML string)
el.insertAdjacentHTML('afterbegin', '&lt;div id="container"&gt;Hello World&lt;/div&gt;');

// Native (Element)
el.insertBefore(newEl, el.firstChild);

// jQuery -------------------------------------------
$(selector).load(url, completeCallback)

// Native
fetch(url).then(data =&gt; data.text()).then(data =&gt; {
  document.querySelector(selector).innerHTML = data
}).then(completeCallback)

// jQuery -------------------------------------------
$(document).ready(eventHandler);

// Native
// Check if the DOMContentLoaded has already been completed
if (document.readyState === 'complete' || document.readyState !== 'loading') {
  eventHandler();
} else {
  document.addEventListener('DOMContentLoaded', eventHandler);
}

//jQuery
$el.clone();

//Native
el.cloneNode();

//jQuery
$el.empty();

//Native
el.innerHTML = '';

// jQuery -------------------------------------------
$('.inner').unwrap();

// Native
Array.prototype.forEach.call(document.querySelectorAll('.inner'), (el) =&gt; {
  Array.prototype.forEach.call(el.childNodes, (child) =&gt; {
    el.parentNode.insertBefore(child, el);
  });
  el.parentNode.removeChild(el);
});

//jQuery
$('.inner').replaceWith('&lt;div class="outer"&gt;&lt;/div&gt;');

//Native
Array.prototype.forEach.call(document.querySelectorAll('.inner'),(el) =&gt; {
  const outer = document.createElement("div");
  outer.className = "outer";
  el.parentNode.insertBefore(outer, el);
  el.parentNode.removeChild(el);
});

// jQuery -------------------------------------------
$el.on(eventName, eventHandler);

// Native
el.addEventListener(eventName, eventHandler);

// jQuery -------------------------------------------
$(el).trigger('custom-event', {key1: 'data'});

// Native
if (window.CustomEvent) {
  const event = new CustomEvent('custom-event', {detail: {key1: 'data'}});
} else {
  const event = document.createEvent('CustomEvent');
  event.initCustomEvent('custom-event', true, true, {key1: 'data'});
}

el.dispatchEvent(event);

// jQuery -------------------------------------------
$.isArray(range);

// Native
Array.isArray(range);

// jQuery -------------------------------------------
$.inArray(item, array);

// Native
array.indexOf(item) &gt; -1;

// ES6-way
array.includes(item);

// jQuery -------------------------------------------
$.extend({}, defaultOpts, opts);

// Native
Object.assign({}, defaultOpts, opts);

// jQuery -------------------------------------------
$.each(array, (index, value) =&gt; {
});

// Native
array.forEach((value, index) =&gt; {
});

// jQuery -------------------------------------------
$promise.done(doneCallback).fail(failCallback).always(alwaysCallback)

// Native
promise.then(doneCallback, failCallback).then(alwaysCallback, alwaysCallback)
// 这个 hack 也是醉了... 不一样吧. 第二个 then 可能返回了东西的

// jQuery -------------------------------------------
$.when($promise1, $promise2).done((promise1Result, promise2Result) =&gt; {
});

// Native
Promise.all([$promise1, $promise2]).then([promise1Result, promise2Result] =&gt; {});

// Deferred 是创建 promises 的一种方式。
// jQuery -------------------------------------------
function asyncFunc() {
  const defer = new $.Deferred();
  setTimeout(() =&gt; {
    if(true) {
      defer.resolve('some_value_computed_asynchronously');
    } else {
      defer.reject('failed');
    }
  }, 1000);

  return defer.promise();
}

// Native
function asyncFunc() {
  return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
      if (true) {
        resolve('some_value_computed_asynchronously');
      } else {
        reject('failed');
      }
    }, 1000);
  });
}

// Deferred way
function defer() {
  const deferred = {};
  const promise = new Promise((resolve, reject) =&gt; {
    deferred.resolve = resolve;
    deferred.reject = reject;
  });

  deferred.promise = () =&gt; {
    return promise;
  };

  return deferred;
}

function asyncFunc() {
  const defer = defer();
  setTimeout(() =&gt; {
    if(true) {
      defer.resolve('some_value_computed_asynchronously');
    } else {
      defer.reject('failed');
    }
  }, 1000);

  return defer.promise();
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7"><span class="section-number-3">4.7</span> <span class="todo INPROGRESS">INPROGRESS</span> <a href="https://guide.freecodecamp.org/">https://guide.freecodecamp.org/</a></h3>
<div class="outline-text-3" id="text-4-7">
</div><div id="outline-container-sec-4-7-1" class="outline-4">
<h4 id="sec-4-7-1"><span class="section-number-4">4.7.1</span> <span class="done DONE">DONE</span> JavaScript</h4>
<div class="outline-text-4" id="text-4-7-1">
<ul class="org-ul">
<li>'let' has block scope, 'const' is const
</li>
<li>default parameters
</li>
<li>break, continue, continue with label 我不觉得这是很好的特性, pass
</li>
<li>Array.prototype
<ul class="org-ul">
<li>concat, filter, forEach, find, includes,
</li>
<li>indexOf, lastIndexOf, map, pop, push, reduce, reduceRight,
</li>
<li>reverse, shift (shift to the left)
</li>
<li>every
<ul class="org-ul">
<li>if callback return false, then stop and return false
</li>
<li>not mutating the array
</li>
<li>callback(element, index, array)
</li>
</ul>
</li>
<li>some,
</li>
<li>sort,
</li>
<li>slice: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice">Array.prototype.slice()</a>
<div class="org-src-container">

<pre class="src src-js">var animals = ['ant', 'bison', 'camel', 'duck', 'elephant'];

console.log(animals.slice(2));
// expected output: Array ["camel", "duck", "elephant"]

console.log(animals.slice(2, 4));
// expected output: Array ["camel", "duck"]

console.log(animals.slice(1, 5));
// expected output: Array ["bison", "camel", "duck", "elephant"]
</pre>
</div>
</li>
<li>splice: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice">Array.prototype.splice()</a>
<div class="org-src-container">

<pre class="src src-js">// syntax:
//     array.splice(start[, deleteCount[, item1[, item2[, ...]]]])

var myFish = ['angel', 'clown', 'mandarin', 'sturgeon'];

myFish.splice(2, 0, 'drum'); // insert 'drum' at 2-index position
// myFish is ["angel", "clown", "drum", "mandarin", "sturgeon"]

myFish.splice(2, 1); // remove 1 item at 2-index position (that is, "drum")
// myFish is ["angel", "clown", "mandarin", "sturgeon"]

var myFish = ['angel', 'clown', 'mandarin', 'sturgeon'];
var removed = myFish.splice(-2, 1);
// myFish is ["angel", "clown", "sturgeon"]
// removed is ["mandarin"]

var myFish = ['angel', 'clown', 'mandarin', 'sturgeon'];
var removed = myFish.splice(2);

// myFish is ["angel", "clown"]
// removed is ["mandarin", "sturgeon"]
</pre>
</div>
</li>
</ul>
</li>
<li>map, 顾名思义就可以用
<ul class="org-ul">
<li>clear,
</li>
<li>forEach,
</li>
<li>size,
</li>
<li>get,
</li>
<li>set,
</li>
<li>delete,
</li>
<li>has,
</li>
<li>entries,
</li>
<li>keys,
</li>
<li>values,
</li>
</ul>
</li>
<li>object
<ul class="org-ul">
<li>keys
</li>
<li>hasOwnProperty
</li>
</ul>
</li>
<li>promise TODO
</li>
<li>RegExp TODO
</li>
<li>string
<ul class="org-ul">
<li>fromCharCode
</li>
<li>prototpy
<ul class="org-ul">
<li>concot
</li>
<li>indexOf
</li>
<li>replace
</li>
<li>repeat
</li>
<li>slice
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-4-7-2" class="outline-4">
<h4 id="sec-4-7-2"><span class="section-number-4">4.7.2</span> SQL</h4>
<div class="outline-text-4" id="text-4-7-2">
</div><ol class="org-ol"><li><a id="sec-4-7-2-1" name="sec-4-7-2-1"></a>Basic Operations<br  /><div class="outline-text-5" id="text-4-7-2-1">
<ul class="org-ul">
<li>mysql-cli
</li>
<li>create db
</li>
<li>create table/view, modify table
</li>
<li>insert data
</li>
<li>queries
</li>
<li>update
</li>
<li>create index
</li>
</ul>
</div>
</li>
<li><a id="sec-4-7-2-2" name="sec-4-7-2-2"></a>DataGrip<br  /><div class="outline-text-5" id="text-4-7-2-2">
<ul class="org-ul">
<li>config db
</li>
<li>open db console, eval script
</li>
<li>copy insert scripts to file/clipboard
</li>
<li>set autoincrement
</li>
</ul>
</div>
</li></ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: TANG ZhiXiong</p>
<p class="date">Created: 2018-01-13 Sat 18:50</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
